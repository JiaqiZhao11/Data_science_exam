dd %>% filter(w2 == 0.2) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(alpha~w1, labeller = label_both)+
geom_text(data = datatext%>% filter(w2 == 0.2), aes(x = 50, y = 0.2, label = round(sse,2)))
dd %>% filter(w2 == 0.1) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(alpha~w1, labeller = label_both)+
geom_text(data = datatext%>% filter(w2 == 0.1), aes(x = 50, y = 0.2, label = round(sse,2)))
dd %>% filter(w2 == 0.2) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(alpha~w1, labeller = label_both)+
geom_text(data = datatext%>% filter(w2 == 0.2), aes(x = 50, y = 0.2, label = round(sse,2)))
datatext = dd %>% group_by(alpha,w1,w2,percept_precision,beta) %>% summarize(sse = sum((exp- perceptmu)^2))
dd %>% filter(w2 == 0.1) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(alpha~w1, labeller = label_both)+
geom_text(data = datatext%>% filter(w2 == 0.1), aes(x = 50, y = 0.2, label = round(sse,2)))
dd %>% filter(w2 == 0.2) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(alpha~w1, labeller = label_both)+
geom_text(data = datatext%>% filter(w2 == 0.2), aes(x = 50, y = 0.2, label = round(sse,2)))
dd %>% filter(w2 == 0.5) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(alpha~w1, labeller = label_both)+
geom_text(data = datatext%>% filter(w2 == 0.5), aes(x = 50, y = 0.2, label = round(sse,2)))
datatext = dd %>% group_by(alpha,w1,w2,percept_precision,beta) %>% summarize(sse = sum((exp- perceptmu)^2))
dd %>% filter(alpha == 0.3) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(w1~w2, labeller = label_both)+
geom_text(data = datatext%>% filter(alpha == 0.3), aes(x = 50, y = 0.2, label = round(sse,2)))
datatext = dd %>% group_by(alpha,w1,w2,percept_precision,beta) %>% summarize(sse = sum((exp- perceptmu)^2))
dd %>% filter(alpha == 0.3) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(w1~w2, labeller = label_both)+
geom_text(data = datatext%>% filter(alpha == 0.3), aes(x = 50, y = 0.2, label = round(sse,2)))
View(dd)
View(dd)
dd %>% filter(alpha == 0.3)
dd %>% filter(alpha == 0.3)
dd %>% filter(alpha == 0.1) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(w1~w2, labeller = label_both)+
geom_text(data = datatext%>% filter(alpha == 0.3), aes(x = 50, y = 0.2, label = round(sse,2)))
unique(dd$alpha)
dd %>% filter(alpha == 0.3) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(w1~w2, labeller = label_both)+
geom_text(data = datatext%>% filter(alpha == 0.3), aes(x = 50, y = 0.2, label = round(sse,2)))
dd %>% filter(alpha == 0.5) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(w1~w2, labeller = label_both)+
geom_text(data = datatext%>% filter(alpha == 0.3), aes(x = 50, y = 0.2, label = round(sse,2)))
dd %>% filter(alpha == 0.4) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(w1~w2, labeller = label_both)+
geom_text(data = datatext%>% filter(alpha == 0.3), aes(x = 50, y = 0.2, label = round(sse,2)))
datatext
dd %>% filter(alpha == 0.2) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(w1~w2, labeller = label_both)+
geom_text(data = datatext%>% filter(alpha == 0.3), aes(x = 50, y = 0.2, label = round(sse,2)))
datatext = dd %>% group_by(alpha,w1,w2,percept_precision,beta) %>% summarize(sse = sum((exp- perceptmu)^2))
dd %>% filter(alpha == 0.2) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(w1~w2, labeller = label_both)+
geom_text(data = datatext%>% filter(alpha == 0.2), aes(x = 50, y = 0.2, label = round(sse,2)))
source(here::here("Bayes_agent.R"))
alpha = seq(0.1,0.5,by = 0.1)
w1 = seq(0,1,by = 0.2)
w2 = seq(0,1,by = 0.2)
percept_precision = 100
beta = 50
parameters = expand.grid(alpha = alpha, w1 =  w1, w2 = w2, percept_precision = percept_precision, beta = beta)
parameters$id = 1:nrow(parameters)
data_list <- split(parameters, parameters$id)
plan(multisession, workers = 6)
dd = furrr::future_map_dfr(data_list, ~weighted_Bayes_f(.x), .progress = TRUE)
datatext = dd %>% group_by(alpha,w1,w2,percept_precision,beta) %>% summarize(sse = sum((exp- perceptmu)^2))
dd %>% filter(alpha == 0.2) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(w1~w2, labeller = label_both)+
geom_text(data = datatext%>% filter(alpha == 0.2), aes(x = 50, y = 0.2, label = round(sse,2)))
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("~/Data-science/myRW_real.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
rstan:::rstudio_stanc("weighted_bayes.stan")
92340/483900
View(dd)
dd_stan = weighted_Bayes_f(data_list[[1]])
View(dd_stan)
dd_stan = weighted_Bayes_f(data_list[[24]])
View(dd_stan)
dd_stan = weighted_Bayes_f(data_list[[60]])
View(dd_stan)
dd_stan = weighted_Bayes_f(data_list[[51]])
View(dd_stan)
source(here::here("weighted_bayes.stan"))
file <- file.path(here::here("weighted_bayes.stan"))
mod_GCM <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE),
stanc_options = list("O1"))
weighted_bayes_data <- list(
ntrials = nrow(dd_stan),
cue = dd_stan$cue,
stim = dd_stan$stim,
u = dd_stan$u,
pred = dd_stan$pred,
percept = dd_stan$percept,
percept_bin = dd_stan$percept_bin
)
samples <- mod_GCM$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
rstan:::rstudio_stanc("weighted_bayes.stan")
samples <- mod_GCM$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
dd_stan = weighted_Bayes_f(data_list[[51]])
file <- file.path(here::here("weighted_bayes.stan"))
mod_GCM <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE),
stanc_options = list("O1"))
weighted_bayes_data <- list(
ntrials = nrow(dd_stan),
cue = dd_stan$cue,
stim = dd_stan$stim,
u = dd_stan$u,
pred = dd_stan$pred,
percept = dd_stan$percept,
percept_bin = dd_stan$percept_bin
)
samples <- mod_GCM$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
rstan:::rstudio_stanc("weighted_bayes.stan")
dd_stan = weighted_Bayes_f(data_list[[51]])
file <- file.path(here::here("weighted_bayes.stan"))
mod_bayes <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE),
stanc_options = list("O1"))
weighted_bayes_data <- list(
ntrials = nrow(dd_stan),
cue = dd_stan$cue,
stim = dd_stan$stim,
u = dd_stan$u,
pred = dd_stan$pred,
percept = dd_stan$percept,
percept_bin = dd_stan$percept_bin
)
samples <- mod_bayes$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
View(dd_stan)
rstan:::rstudio_stanc("weighted_bayes.stan")
dd_stan = weighted_Bayes_f(data_list[[51]])
file <- file.path(here::here("weighted_bayes.stan"))
mod_bayes <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE),
stanc_options = list("O1"))
weighted_bayes_data <- list(
ntrials = nrow(dd_stan),
cue = dd_stan$cue,
stim = dd_stan$stim,
u = dd_stan$u,
pred = dd_stan$pred,
percept = dd_stan$percept,
percept_bin = dd_stan$percept_bin
)
samples <- mod_bayes$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
rstan:::rstudio_stanc("weighted_bayes.stan")
file <- file.path(here::here("weighted_bayes.stan"))
mod_bayes <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE),
stanc_options = list("O1"))
weighted_bayes_data <- list(
ntrials = nrow(dd_stan),
cue = dd_stan$cue,
stim = dd_stan$stim,
u = dd_stan$u,
pred = dd_stan$pred,
percept = dd_stan$percept,
percept_bin = dd_stan$percept_bin
)
samples <- mod_bayes$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
rstan:::rstudio_stanc("weighted_bayes.stan")
dd_stan = weighted_Bayes_f(data_list[[51]])
file <- file.path(here::here("weighted_bayes.stan"))
mod_bayes <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE),
stanc_options = list("O1"))
weighted_bayes_data <- list(
ntrials = nrow(dd_stan),
cue = dd_stan$cue,
stim = dd_stan$stim,
u = dd_stan$u,
pred = dd_stan$pred,
percept = dd_stan$percept,
percept_bin = dd_stan$percept_bin
)
samples <- mod_bayes$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
samples$cmdstan_diagnose()
sum = samples_gcm$summary()
View(sum)
sum = samples$summary()
View(sum)
dd_stan = weighted_Bayes_f(data_list[[90]])
#source(here::here("agent.R"))
source(here::here("Bayes_agent.R"))
alpha = seq(0.1,0.5,by = 0.1)
w1 = seq(0,1,by = 0.2)
w2 = seq(0,1,by = 0.2)
percept_precision = 100
beta = 50
parameters = expand.grid(alpha = alpha, w1 =  w1, w2 = w2, percept_precision = percept_precision, beta = beta)
parameters$id = 1:nrow(parameters)
data_list <- split(parameters, parameters$id)
plan(multisession, workers = 6)
dd = furrr::future_map_dfr(data_list, ~weighted_Bayes_f(.x), .progress = TRUE)
datatext = dd %>% group_by(alpha,w1,w2,percept_precision,beta) %>% summarize(sse = sum((exp- perceptmu)^2))
dd %>% filter(alpha == 0.2) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(w1~w2, labeller = label_both)+
geom_text(data = datatext%>% filter(alpha == 0.2), aes(x = 50, y = 0.2, label = round(sse,2)))
dd %>% filter(w2 == 0.2) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(alpha~w1, labeller = label_both)+
geom_text(data = datatext%>% filter(w2 == 0.2), aes(x = 50, y = 0.2, label = round(sse,2)))
dd %>% filter(w2 == 0.5) %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")+
facet_grid(alpha~w1, labeller = label_both)+
geom_text(data = datatext%>% filter(w2 == 0.5), aes(x = 50, y = 0.2, label = round(sse,2)))
dd_stan = weighted_Bayes_f(data_list[[90]])
View(dd_stan)
dd_stan = weighted_Bayes_f(data_list[[90]])
file <- file.path(here::here("weighted_bayes.stan"))
mod_bayes <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE),
stanc_options = list("O1"))
weighted_bayes_data <- list(
ntrials = nrow(dd_stan),
cue = dd_stan$cue,
stim = dd_stan$stim,
u = dd_stan$u,
pred = dd_stan$pred,
percept = dd_stan$percept,
percept_bin = dd_stan$percept_bin
)
samples <- mod_bayes$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
hist(dd_stan$percept)
dd_stan = weighted_Bayes_f(data_list[[35]])
View(dd_stan)
source(here::here("Bayes_agent.R"))
alpha = 0.3
w1 = 0.4
w2 = 0.8
percept_precision = 100
beta = 50
parameters = expand.grid(alpha = alpha, w1 =  w1, w2 = w2, percept_precision = percept_precision, beta = beta)
dd_stan = weighted_Bayes_f(data_list[[35]])
file <- file.path(here::here("weighted_bayes.stan"))
mod_bayes <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE),
stanc_options = list("O1"))
weighted_bayes_data <- list(
ntrials = nrow(dd_stan),
cue = dd_stan$cue,
stim = dd_stan$stim,
u = dd_stan$u,
pred = dd_stan$pred,
percept = dd_stan$percept,
percept_bin = dd_stan$percept_bin
)
samples <- mod_bayes$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
source(here::here("Bayes_agent.R"))
alpha = 0.3
w1 = 0.4
w2 = 0.8
percept_precision = 100
beta = 50
parameters = expand.grid(alpha = alpha, w1 =  w1, w2 = w2, percept_precision = percept_precision, beta = beta)
dd_stan = weighted_Bayes_f(data_list[[35]])
dd_stan %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")
View(dd_stan)
source(here::here("Bayes_agent.R"))
alpha = 0.3
w1 = 0.4
w2 = 0.8
percept_precision = 100
beta = 50
parameters = expand.grid(alpha = alpha, w1 =  w1, w2 = w2, percept_precision = percept_precision, beta = beta)
dd_stan = weighted_Bayes_f(parameters)
View(dd_stan)
dd_stan %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")
source(here::here("Bayes_agent.R"))
alpha = 0.3
w1 = 0.4
w2 = 0.3
percept_precision = 100
beta = 50
parameters = expand.grid(alpha = alpha, w1 =  w1, w2 = w2, percept_precision = percept_precision, beta = beta)
dd_stan = weighted_Bayes_f(parameters)
dd_stan %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")
file <- file.path(here::here("weighted_bayes.stan"))
mod_bayes <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE),
stanc_options = list("O1"))
weighted_bayes_data <- list(
ntrials = nrow(dd_stan),
cue = dd_stan$cue,
stim = dd_stan$stim,
u = dd_stan$u,
pred = dd_stan$pred,
percept = dd_stan$percept,
percept_bin = dd_stan$percept_bin
)
samples <- mod_bayes$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
samples$cmdstan_diagnose()
sum = samples$summary()
View(sum)
View(dd_stan)
source(here::here("Bayes_agent.R"))
alpha = 0.2
w1 = 0.5
w2 = 0.3
percept_precision = 50
beta = 100
parameters = expand.grid(alpha = alpha, w1 =  w1, w2 = w2, percept_precision = percept_precision, beta = beta)
dd_stan = weighted_Bayes_f(parameters)
dd_stan %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = perceptmu), col = "green")
source(here::here("Bayes_agent.R"))
alpha = 0.2
w1 = 0.5
w2 = 0.1
percept_precision = 50
beta = 100
parameters = expand.grid(alpha = alpha, w1 =  w1, w2 = w2, percept_precision = percept_precision, beta = beta)
dd_stan = weighted_Bayes_f(parameters)
dd_stan %>% ggplot()+
geom_line(aes(x = x, y = exp))+
geom_point(aes(x = x, y = stim-0.1), col = "blue")+
geom_line(aes(x = x, y = percept), col = "green")
View(dd_stan)
file <- file.path(here::here("weighted_bayes.stan"))
mod_bayes <- cmdstan_model(file, cpp_options = list(stan_threads = TRUE),
stanc_options = list("O1"))
weighted_bayes_data <- list(
ntrials = nrow(dd_stan),
cue = dd_stan$cue,
stim = dd_stan$stim,
u = dd_stan$u,
pred = dd_stan$pred,
percept = dd_stan$percept,
percept_bin = dd_stan$percept_bin
)
samples <- mod_bayes$sample(
data = weighted_bayes_data,
seed = 123,
chains = 4,
parallel_chains = 4,
threads_per_chain = 4,
iter_warmup = 1000,
iter_sampling = 1000,
refresh = 100
)
samples$cmdstan_diagnose()
sum = samples$summary()
View(sum)
rstan:::rstudio_stanc("weighted_bayes.stan")
